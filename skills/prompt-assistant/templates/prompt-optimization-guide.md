# 提示词优化指南 (Prompt Optimization Guide)

用于分析和改进现有的提示词，使其更有效、更清晰。

## 优化的目的和益处

### 为什么优化提示词
- **效率**: 清晰的提示词产生更好的结果，需要更少的迭代
- **一致性**: 优化的提示词在不同情况下产生更一致的输出
- **成本**: 简洁的提示词减少token使用，降低API成本
- **可维护性**: 结构清晰的提示词更容易修改和改进

### 常见问题迹象
- ❌ AI的回应偏离预期
- ❌ 输出格式不一致
- ❌ AI请求澄清或额外信息
- ❌ 结果中遗漏关键信息
- ❌ 回应过长或过短
- ❌ 同一提示词的结果差异大

## 优化分析框架

### 步骤 1: 评估当前提示词

**检查清单**:

#### 清晰度 (Clarity)
- [ ] 目标明确陈述（AI应该做什么？）
- [ ] 术语定义清楚（没有假设AI理解术语）
- [ ] 结构易于跟踪（不混杂多个想法）
- [ ] 没有歧义或双重含义

**评分**: 高 / 中 / 低
**改进建议**: _如果得分低，需要明确目标和期望_

#### 完整性 (Completeness)
- [ ] 输入格式已定义（AI应该期望什么输入）
- [ ] 输出格式已指定（应该产生什么）
- [ ] 约束条件列出（禁止什么，允许什么）
- [ ] 成功标准明确（如何知道这是对的）

**评分**: 高 / 中 / 低
**改进建议**: _如果缺少信息，AI会填空或请求澄清_

#### 结构 (Structure)
- [ ] 逻辑流程（想法按顺序呈现）
- [ ] 分节明确（不同概念分开）
- [ ] 一致的格式（类似的想法以相似方式呈现）
- [ ] 长度适当（不过长，不过短）

**评分**: 高 / 中 / 低
**改进建议**: _重组使用标题和列表_

#### 示例 (Examples)
- [ ] 包含至少一个例子
- [ ] 例子展示实际使用情况
- [ ] 例子涵盖主要场景
- [ ] 例子格式与期望输出匹配

**评分**: 高 / 中 / 低
**改进建议**: _添加具体的input→output示例_

#### 约束 (Constraints)
- [ ] 明确定义边界情况
- [ ] 说明如何处理错误
- [ ] 列出限制条件
- [ ] 定义优先规则（如果冲突）

**评分**: 高 / 中 / 低
**改进建议**: _添加 "edge cases" 和 "error handling" 部分_

### 步骤 2: 识别问题

**问题映射表**:

| 症状 | 可能原因 | 解决方案 |
|-----|--------|--------|
| 输出完全错误 | 目标不清楚或被误解 | 重写目标，添加"不做"列表 |
| 格式不对 | 输出格式没有明确指定 | 添加"输出格式"部分，示例 |
| 缺少信息 | 没有说明需要什么细节 | 明确列出"必需"和"可选"信息 |
| 太冗长 | 没有长度限制或聚焦 | 添加长度约束和"关键点"指引 |
| 太简短 | 没有说明需要详细程度 | 要求"详细"、"分步"、"100词+"等 |
| 不一致或冲突 | 约束不清楚 | 优先级规则和解决冲突的指导 |

### 步骤 3: 提出改进

常见的改进机制:

```markdown
## 改进 1: 明确目标

❌ 原始: "帮我写文案"
✅ 改进: "为Instagram帖子创建3条产品宣传文案，每条最多150字，包含emoji，调用行为强烈，针对18-35岁用户"

---

## 改进 2: 定义输出格式

❌ 原始: "给我列出要点"  
✅ 改进: "创建以下格式的要点列表:
- 主要要点
  - 支持细节 1
  - 支持细节 2
保持每个要点在一行内"

---

## 改进 3: 添加具体示例

❌ 原始: "提取关键信息"
✅ 改进: "从文本中提取关键信息并以JSON格式返回:

输入: '公司X于2024年1月推出新产品，销售额达100万'
输出:
\`\`\`json
{
  \"company\": \"X\",
  \"date\": \"2024-01-01\",
  \"action\": \"新产品推出\",
  \"metric\": \"100万\",
  \"metric_type\": \"销售额\"
}
\`\`\`"

---

## 改进 4: 明确约束

❌ 原始: "写一篇文章"
✅ 改进: "写一篇800词的技术文章，要求:
- 目标受众: 初级开发者
- 不包含代码
- 4个主要章节
- 避免行业术语或定义所有术语
- 包含实际案例"

---

## 改进 5: 处理边界情况

❌ 原始: "分析数据"
✅ 改进: "分析销售数据并:
- 如果数据缺失超过30%，报告为'不可靠'
- 如果没有明显趋势，说'数据波动无明显模式'
- 如果有异常值，标记并解释"
```

### 步骤 4: 创建优化的提示词

使用这个模板重新组织:

```markdown
## [优化后的提示词标题]

### 目标
[清晰、具体的目标]

### 输入
[你期望什么样的输入]

### 输出格式
[精确的格式说明，包括示例]

### 关键要求
- [要求 1]
- [要求 2]
- [要求 3]

### 约束条件
- [约束 1]
- [约束 2]

### 边界情况处理
- [场景] → [处理方式]

### 示例

**示例 1**:
**输入**: [实际输入示例]
**输出**: [期望的精确输出]

**示例 2**:
[另一个示例]
```

### 步骤 5: 验证改进

在优化后，验证新提示词:

**测试清单**:
- [ ] 用不同的输入测试至少3次
- [ ] 结果是否一致？
- [ ] 格式是否符合规范？
- [ ] 是否包含所有期望的信息？
- [ ] 有任何不必要的内容吗？

**反复迭代**:
如果仍有问题，返回到步骤 2 进行进一步优化。

---

## 优化案例研究

### 案例 1: 数据提取

#### 原始提示词
```
从文本中提取公司信息
```

**问题**:
- 不清楚什么是"公司信息"
- 什么格式的输出？
- 如果信息没有？

#### 优化过程

**第1轮评估**:
- 清晰度: 低 ❌
- 完整性: 低 ❌
- 结构: 低 ❌
- 示例: 无 ❌
- 约束: 无 ❌

**第2轮改进建议**:
1. 定义"公司信息"= 名称、成立日期、行业、员工数
2. 添加JSON输出格式
3. 包含处理缺失字段的说明

#### 优化的提示词
```
### 任务: 公司信息提取

从给定文本中提取公司详情并返回JSON。

**提取字段**:
- company_name: 公司名称
- founded_date: 成立日期(YYYY-MM-DD)
- industry: 行业分类
- employee_count: 员工数量(整数)

**输出格式**:
\`\`\`json
{
  "company_name": "string",
  "founded_date": "YYYY-MM-DD或null如果不清楚",
  "industry": "string或null",
  "employee_count": "integer或null",
  "confidence": "high/medium/low"
}
\`\`\`

**规则**:
- 如果信息不在文本中，返回null而不是猜测
- 置信度反映信息的清晰程度
- 日期必须是有效的YYYY-MM-DD或null

**示例**:
输入: "Apple科技公司成立于1976年，位于加州，拥有约15万员工"
输出:
\`\`\`json
{
  "company_name": "Apple",
  "founded_date": "1976-01-01",
  "industry": "科技",
  "employee_count": 150000,
  "confidence": "high"
}
\`\`\`
```

#### 结果
✅ 输出一致且结构化
✅ 明确处理缺失数据
✅ 易于集成到系统中

---

### 案例 2: 内容创意

#### 原始提示词
```
为产品创建营销创意
```

**问题**:
- 什么类型的创意？(文案、视觉、战略？)
- 目标受众是谁？
- 应该有多少概念？
- 应该有多详细？

#### 优化的提示词
```
### 任务: 社交媒体营销创意生成

为[产品名称]创建3个新的、有创意的社交媒体营销概念。

**目标受众**: 女性, 25-45岁, 关心健康和可持续生活方式

**每个概念应包含**:
1. 概念标题 - 简洁、吸引人
2. 核心信息 - 1-2句话说明核心优势
3. 视觉方向 - 描述图像或视频风格
4. 平台适配 - 为Instagram/TikTok/LinkedIn优化
5. 文案示例 - 150字的社交文案示例
6. 号召性用语 - 明确的下一步

**约束条件**:
- 避免平凡的营销语言
- 真实、有真理感
- 可高效执行(不需要专业摄影)
- 与品牌价值一致

**示例概念结构**:
```
概念: "日常英雄"
核心信息: 普通人通过小决定改变他们的健康
视觉: 自然光线，真实人物，最小主义背景
Instagram: 短视频轮播，用户评论...
```

```

#### 结果
✅ 创意更相关，更易执行
✅ 与品牌方向一致
✅ 可直接用于制作

---

## 常见优化模式

### 模式 1: 添加"角色"定义

**为什么**: 给AI适当的"个性"和背景知识

```markdown
❌ 改进前: "翻译这个句子"
✅ 改进后: "作为一个精通中英文的翻译，保留原文的语气和风格，翻译以下句子..."
```

### 模式 2: 使用"思考过程"

**为什么**: 指导AI显示推理，提高准确性

```markdown
❌ 改进前: "决定这是否是垃圾邮件"
✅ 改进后: "判断以下电子邮件是否是垃圾邮件。
首先分析:发件人、主题行标记、请求的操作、是否有真实的个人化。
然后做出决定: 垃圾邮件/合法/可疑"
```

### 模式 3: 明确的"不做"列表

**为什么**: 防止不需要的输出或行为

```markdown
❌ 改进前: "写一个产品描述"
✅ 改进后: "写一个产品描述
要求: [清单]
不要: 
- 使用超级激进的营销术语
- 做出无法支持的声称
- 包含竞争对手比较"
```

### 模式 4: 分步幅度指引

**为什么**: 对复杂任务提供结构化方法

```markdown
❌ 改进前: "分析为什么销售下降"
✅ 改进后: "分析销售下降。按以下顺序:
1. 识别下降的时间范围和幅度(百分比)
2. 考虑可能原因(市场、产品、定价、竞争)
3. 检查相关数据(哪个细分受影响最大)
4. 得出最可能的原因
5. 建议3个行动项来逆转趋势"
```

---

## 优化检查清单

当优化提示词时，确保：

**内容**:
- [ ] 目标在第一句清晰陈述
- [ ] 有具体例子(输入和输出)
- [ ] 所有特殊术语都定义了
- [ ] 没有隐含假设

**格式**:
- [ ] 使用标题组织内容
- [ ] 列表用于多项(而不是段落)
- [ ] 重要信息突出显示或强调
- [ ] 代码块或示例清晰格式化

**完整性**:
- [ ] 定义了输入和输出
- [ ] 列出了所有约束
- [ ] 解释了边界情况
- [ ] 成功标准很清楚

**简洁性**:
- [ ] 没有冗余措辞
- [ ] 没有包含不需要的背景
- [ ] 长度与复杂性成正比
- [ ] 每句话都有目的

---

## 优化工具和资源

### 工具提示
- **使用版本控制**: 保持优化提示词的版本历史记录
- **A/B测试**: 测试两个版本的提示词，比较结果
- **提示词库**: 维护已优化提示词的集合
- **反馈循环**: 记录结果不好的提示词以改进

### 测试框架

```
优化前:
- 测试5次，记录变化
- 计算一致性百分比
- 标记任何不需要的输出

优化后:
- 用相同输入再测试5次
- 计算改进后的一致性
- 比较输出质量

改进度 = (优化后一致性 - 优化前一致性) / 优化前一致性 × 100%
```

目标: 一致性提高至少 20-30%，或无需迭代次数减少。

